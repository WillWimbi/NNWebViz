<!DOCTYPE html>
<html>
<head>
  <title>TensorFlow.js Neural Network</title>
  <!-- Load TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
</head>
<body>
  <h1>Train a Neural Network in Browser</h1>
  <canvas id="visualization"></canvas> <!-- Optional: For visualizing training -->
  <script>
    function loadMnistData(folder="C:\Users\willw\Downloads\MNIST Dataset JPG format\MNIST - JPG - training"){
        for(fol in folders){
            fol[0]
        }

    }



    // Your TensorFlow.js code here
    async function trainModel() {
            // Create a simple model.
        const model = tf.sequential();
        model.add(tf.layers.dense({units: 1, inputShape: [1]}));

        let epochs = 300;

        function *dataGenerator(){
            while (true){        
            const x = tf.randomUniform([32, 1], -5, 5); // Batch of 32
            const y = x.mul(2).sub(1);
            yield { xs: x, ys: y };
            }
        }

        const dataset = tf.data.generator(dataGenerator);
        // Prepare the model for training: Specify the loss and the optimizer.
        model.compile({loss: 'meanSquaredError', optimizer: 'sgd'});
        await model.fitDataset(dataset,{
            epochs: epochs,
            batchesPerEpoch: 20,
            callbacks: {
                onEpochEnd:(epoch,logs) => {
                    console.log(`Epochs:${epoch}: Loss: ${logs.loss}`);
                }

            }

        });


        
        // const f = x => x.square();              // define f(x) = x^2
        // const df = tf.grad(f);                  // df is now a function that gives gradient of f
        // const x = tf.tensor1d([1, 2, 3]);
        // df(x).print();  // Should print [2, 4, 6]
        // Generate some synthetic data for training. (y = 2x - 1)
        // const xs = tf.tensor2d([-9.1321,5.795,105,56,13], [5, 1]);
        // const ys = tf.tensor2d([-3, -1, 1, 3, 5, 7], [5, 1]);
            // Example prediction
            // Need to provide shape as second parameter for flat arrays
            const prediction = model.predict(tf.tensor2d([-9.1321, 5.795, 105, 56, 13], [5, 1]));
            console.log(prediction.dataSync());
            }

    // Run training when the page loads
    window.onload = trainModel;
  </script>
</body>
</html>